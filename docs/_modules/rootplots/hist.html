
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>qksplot.hist &#8212; qksplot 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">qksplot 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for qksplot.hist</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module defines classes required for histogramming:</span>
<span class="sd">    :class:`Hist1D &lt;Hist1D&gt;` - A 1D histogram</span>

<span class="sd">    :class:`Hist2D &lt;Hist2D&gt;` - A 2D histogram</span>

<span class="sd">    :class:`Hist3D &lt;Hist3D&gt;` - A 3D histogram</span>

<span class="sd">    :class:`HistND &lt;HistND&gt;` - An N-Dimensional histogram</span>

<span class="sd">Note:</span>
<span class="sd">    The classes defined in this module do **NOT** provide drawing capabilities, so there is **NO** draw() nor paint()</span>
<span class="sd">    method. Use other libraries like matplotlib to plot the data. But for your convenience, this package provides a </span>
<span class="sd">    module for easy plotting using matplotlib. See, :py:mod:`qksplot.mpl`</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">bisect</span> <span class="k">import</span> <span class="n">bisect_left</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="s1">&#39;HistAxis&#39;</span><span class="p">,</span> <span class="s1">&#39;HistND&#39;</span><span class="p">,</span> <span class="s1">&#39;Hist1D&#39;</span><span class="p">,</span> <span class="s1">&#39;Hist2D&#39;</span><span class="p">,</span> <span class="s1">&#39;Hist3D&#39;</span>


<div class="viewcode-block" id="HistAxis"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis">[docs]</a><span class="k">class</span> <span class="nc">HistAxis</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; An axis for use in constructing histograms</span>

<span class="sd">    Args:</span>
<span class="sd">        bins (Sequence): an ordered (ascending order) array of floats containing the lower edges of the bins</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">title</span>  <span class="c1"># the label of the axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span> <span class="o">=</span> <span class="n">bins</span>  <span class="c1"># an array with the low edges of the bins</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">minBin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; returns the minimum low edge of first bin &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maxBin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; returns the maximum right edge of the last bin &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbins</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; returns the total number of the bins&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>

    <span class="nd">@title</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; sets the label of the axis&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>

<div class="viewcode-block" id="HistAxis.density"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; the density of the bins = number of bins over the length (maxBin - minBin)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minBin</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxBin</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxBin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MinBin can not be equalx to MaxBin.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistAxis.get_bin"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis.get_bin">[docs]</a>    <span class="k">def</span> <span class="nf">get_bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Returns the bin index that contains &#39;x&#39; value, such that for that bin ``minBin &lt;= x &lt; maxBin``</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float): a valid value on the axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. Or, -1 is returned if there is no such bin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minBin</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxBin</span><span class="p">:</span>  <span class="c1"># sane check</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">return</span> <span class="n">bisect_left</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="HistAxis.get_bins"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis.get_bins">[docs]</a>    <span class="k">def</span> <span class="nf">get_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Returns all bins lower edges of the axis.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]. A list with lower edges of each bin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span></div>

<div class="viewcode-block" id="HistAxis.get_bin_center"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis.get_bin_center">[docs]</a>    <span class="k">def</span> <span class="nf">get_bin_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Returns the value of the center in bin &#39;i&#39; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bin_width</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistAxis.get_bins_centers"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistAxis.get_bins_centers">[docs]</a>    <span class="k">def</span> <span class="nf">get_bins_centers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the a list containing the centers of all bins.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lowEdge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lowEdge</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bin_width</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="nf">get_bin_lower_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_bin_upper_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_bin_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bin_width</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="HistND"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND">[docs]</a><span class="k">class</span> <span class="nc">HistND</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; An N-Dimensional Histogram.</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int): the number of dimensions of the histogram</span>

<span class="sd">            minBin (Sequence): an array containing the minimum value of lower (leftmost) edge of bins for each dimension.</span>

<span class="sd">            maxBin (Sequence): an array containing the maximum value of upper (rightmost) edge of bins for each dimension.</span>

<span class="sd">            nBins (Sequence):  an array containing the number of bins for each dimension.</span>

<span class="sd">            title (string): the title of the histogram.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">minBin</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">maxBin</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">nBins</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span> <span class="o">=</span> <span class="n">dim</span>  <span class="c1"># number of dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">title</span>  <span class="c1"># the title of the histogram.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_entries</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># total number of entries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entriesUnderflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entriesOverflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Total Sum of weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Total Sum of weight*weight</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Total Sum of weight*X for each dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Total Sum of weight*X*X for each dimension</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># a list of axes. 1 axis per each dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sizeOverDims</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># an array of sizes useful for converting to coordinates of linear array of cells</span>
        <span class="n">n_cells</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="n">binsLeftEdges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minBin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">maxBin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nBins</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binsLeftEdges</span><span class="p">,</span> <span class="n">maxBin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HistAxis</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sizeOverDims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_cells</span><span class="p">)</span>
            <span class="n">n_cells</span> <span class="o">=</span> <span class="n">n_cells</span> <span class="o">*</span> <span class="n">nBins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nCells</span> <span class="o">=</span> <span class="n">n_cells</span>  <span class="c1"># total number of cells (global linear bins)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># contains the number of entries per cell (global linear bins)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># array of sum of squared weights per cell (global linear bins)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;number of dimensions &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; the title of the histogram &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span>

    <span class="nd">@title</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; sets the title of the histogram &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">t</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; total number of entries &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entries</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;total number of cells (global linear bins)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nCells</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_of_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total Sum of weights&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_of_weights2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Total Sum of weights squared&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_of_weightsX</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; a list of total sum of weights*X for each dimension&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_of_weightsX2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;a list of total sum of weights*X*X for each dimension&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span>

<div class="viewcode-block" id="HistND.get_axes_list"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_axes_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_axes_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">HistAxis</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; a list of axes &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span></div>

<div class="viewcode-block" id="HistND.get_axis"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_axis">[docs]</a>    <span class="k">def</span> <span class="nf">get_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HistAxis</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;get the axis for dimension &#39;i&#39; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="HistND.cell_to_bins"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.cell_to_bins">[docs]</a>    <span class="k">def</span> <span class="nf">cell_to_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx_cell</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; Converts cell index to indexes of bins.</span>

<span class="sd">        returns a list of bin indexes on the axes that refer to this cell &quot;idx_cell&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            idx_cell (int): the cell indexes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[int]. A length of the same as the histogram dimension</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`bins_to_cell`, :py:meth:`pos_to_cell`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">idx_cell</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">idxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">idx_cell</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_sizeOverDims</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">idxBins</span></div>

<div class="viewcode-block" id="HistND.bins_to_cell"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.bins_to_cell">[docs]</a>    <span class="k">def</span> <span class="nf">bins_to_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Converts bin indexes to global linear bin (cell) index.</span>

<span class="sd">        Returns the index of the cell that is located by the bin indexes on the axes</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): bin index on each dimension. The number of arguments must be the same as</span>
<span class="sd">                the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. The cell index (global linear bin index)</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`cell_to_bins`, :py:meth:`pos_to_cell`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx_cell</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">idx_cell</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sizeOverDims</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">idx_cell</span></div>

<div class="viewcode-block" id="HistND.pos_to_cell"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.pos_to_cell">[docs]</a>    <span class="k">def</span> <span class="nf">pos_to_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Converts coordinate positions to global linear bin (cell) index.</span>

<span class="sd">        Returns the cell index (global linear bin) that contains the point at position &#39;x&#39;. Where &#39;x&#39; are the</span>
<span class="sd">        coordinates of a point in :py:meth:`dimension`.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): positions on each dimension. The number of arguments must be the same as</span>
<span class="sd">                the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. If there is no such bin a -1 is returned.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`bins_to_cell`, :py:meth:`cell_to_bins`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bin_coords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xL</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">xL</span><span class="p">:</span>
                <span class="n">bin_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bin_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">bin_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bin_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">bin_coords</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistND.get_bins_edges"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_bins_edges">[docs]</a>    <span class="k">def</span> <span class="nf">get_bins_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeEmptyBins</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot; Returns all bins per each dimension (axis).  By default it **does not** include empty cells.</span>

<span class="sd">        The list contains for each dimension the list of minimum edges for each cell (global linear bin)</span>

<span class="sd">        Args:</span>
<span class="sd">            includeEmptyBins (bool): if empty bins are included in the list. If True then empty bins are included,</span>
<span class="sd">                otherwise they are NOT included</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">includeEmptyBins</span><span class="p">:</span>  <span class="c1"># include all bins (including the empty ones)</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bins</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="k">for</span> <span class="n">icell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="n">cell_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">icell</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cell_value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">idxBins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">icell</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">ibin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idxBins</span><span class="p">):</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_lower_edge</span><span class="p">(</span><span class="n">ibin</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.get_bins_centers"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_bins_centers">[docs]</a>    <span class="k">def</span> <span class="nf">get_bins_centers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeEmptyBins</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot; Returns the positions of the centers of all bins per each dimension (axis).</span>
<span class="sd">        By default it **does not** include empty cells.</span>

<span class="sd">        Args:</span>
<span class="sd">            includeEmptyBins (bool): if empty bins are included in the list. If True then empty bins are included,</span>
<span class="sd">                otherwise they are NOT included</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">includeEmptyBins</span><span class="p">:</span>  <span class="c1"># include all bins (including the empty ones)</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bins_centers</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="k">for</span> <span class="n">icell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="n">cell_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">icell</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cell_value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">idxBins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">icell</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">ibin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idxBins</span><span class="p">):</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">ibin</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.get_cell_content"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_cell_content">[docs]</a>    <span class="k">def</span> <span class="nf">get_cell_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Returns the content of the cell &#39;i&#39; or the value of Underflow (if i&lt;0) or Overflow (if i&gt;= # of cells)</span>

<span class="sd">        Args:</span>
<span class="sd">            i (int): a valid cell index (aka global linear bin)</span>

<span class="sd">        Returns:</span>
<span class="sd">            float or 0.0 if the position is outside cells ranges</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entriesUnderflow</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entriesOverflow</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="HistND.get_cells_contents"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_cells_contents">[docs]</a>    <span class="k">def</span> <span class="nf">get_cells_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeEmptyBins</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; Returns the contents of all bins (cells) per each dimension.  By default it **does not** include empty cells.</span>

<span class="sd">       Args:</span>
<span class="sd">           includeEmptyBins (bool): if empty bins are included in the list. If True then empty bins are included,</span>
<span class="sd">                otherwise they are NOT included</span>

<span class="sd">       Returns:</span>
<span class="sd">           list of list.</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">includeEmptyBins</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">icell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="n">cell_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">icell</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cell_value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.get_pos_content"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_pos_content">[docs]</a>    <span class="k">def</span> <span class="nf">get_pos_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the content of the cell located at position x</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): the bin indexes for each dimension. The number of arguments must be the same as</span>
<span class="sd">                the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">        Returns:</span>
<span class="sd">            float or 0.0 if the position is outside bin ranges</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span></div>

<div class="viewcode-block" id="HistND.get_cell_content_error"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_cell_content_error">[docs]</a>    <span class="k">def</span> <span class="nf">get_cell_content_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the error value associated with cell &#39;i&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            i (int): a valid cell index (aka global linear bin)</span>

<span class="sd">        The error is computed as follows:</span>
<span class="sd">            - sqrt(Sum of squared weights): If weights were used during fill</span>
<span class="sd">            - sqrt(bin content): If weights were NOT used during fill</span>

<span class="sd">        Returns:</span>
<span class="sd">            float.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights2</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistND.get_cells_contents_errors"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_cells_contents_errors">[docs]</a>    <span class="k">def</span> <span class="nf">get_cells_contents_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeEmptyBins</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; Returns a list containing the errors associated to each cell.</span>
<span class="sd">        By default it **does not** include empty cells.</span>

<span class="sd">        Args:</span>
<span class="sd">            includeEmptyBins (bool): if empty cell are included in the list. If True then empty cell are included,</span>
<span class="sd">                otherwise they are NOT included</span>

<span class="sd">        Returns:</span>
<span class="sd">            list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">includeEmptyBins</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="n">bin_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content_error</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_err</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="n">cell_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cell_value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">bin_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content_error</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_err</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.get_stats"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.get_stats">[docs]</a>    <span class="k">def</span> <span class="nf">get_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot; Returns general statistics about the histogram.</span>

<span class="sd">            A dictionary with the keys: &quot;Entries&quot;, &quot;SumWeights&quot;, &quot;SumWeights2&quot;, &quot;SumWeightsX&quot;, &quot;SumWeightsX2&quot;</span>

<span class="sd">         Returns:</span>
<span class="sd">            Dict{str,Any}.</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;Entries&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entries</span><span class="p">,</span>
                <span class="s2">&quot;Underflow&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entriesUnderflow</span><span class="p">,</span>
                <span class="s2">&quot;Overflow&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entriesOverflow</span><span class="p">,</span>
                <span class="s2">&quot;SumWeights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights</span><span class="p">,</span>
                <span class="s2">&quot;SumWeights2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights2</span><span class="p">,</span>
                <span class="s2">&quot;SumWeightsX&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">,</span>
                <span class="s2">&quot;SumWeightsX2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span>
                <span class="p">}</span></div>

<div class="viewcode-block" id="HistND.projection"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.projection">[docs]</a>    <span class="k">def</span> <span class="nf">projection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keepDims</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this Histogram to another Histogram keeping the axis defined in `keepDims`</span>

<span class="sd">        Args:</span>
<span class="sd">            keepDims (variadic argument list): a variadic arguments list of the id&#39;s of the dimensions to keep when</span>
<span class="sd">                projecting. The number of dimensions of the projected histogram is the length of `keepDims`</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># keep_dims = sorted(keepDims)</span>
        <span class="n">minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">kdim</span> <span class="ow">in</span> <span class="n">keepDims</span><span class="p">:</span>
            <span class="n">minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">kdim</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">kdim</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">kdim</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keepDims</span><span class="p">),</span> <span class="n">minBins</span><span class="p">,</span> <span class="n">maxBins</span><span class="p">,</span> <span class="n">nBins</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Projection of &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>  <span class="c1"># has length &#39;self.dimension&#39;</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">kdim</span> <span class="ow">in</span> <span class="n">keepDims</span><span class="p">:</span>
                    <span class="n">bins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">[</span><span class="n">kdim</span><span class="p">])</span>
            <span class="n">result</span><span class="o">.</span><span class="n">fill_bins</span><span class="p">(</span><span class="o">*</span><span class="n">bins</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.fill_cell"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.fill_cell">[docs]</a>    <span class="k">def</span> <span class="nf">fill_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i_cell</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Fill the histogram using global cell index.</span>

<span class="sd">        Args:</span>
<span class="sd">            i_cell (int): the global bin index (cell index).</span>

<span class="sd">            kwargs (Dict): currently this dict can accept 2 keys:</span>
<span class="sd">                weight (float) - the weight to fill in. Defaults to 1.0</span>
<span class="sd">                error_per_bin(bool) - whether to compute weights per bins. Default is True</span>
<span class="sd">        </span>
<span class="sd">        Warning: </span>
<span class="sd">            This is expensive operation because it computes the bins indexes (it decomposes cell index) and positions</span>
<span class="sd">            per axis before filling weights per bin. Its Recommended to use other fill_* methods</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. The **index of the affected cell (global linear bin) or -1** if no cell was found or the input values</span>
<span class="sd">            are not valid (underflow or overflow)</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`fill_pos`, :py:meth:`fill_bins`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># sane check</span>
        <span class="k">if</span> <span class="n">i_cell</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entriesUnderflow</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">i_cell</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entriesOverflow</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">error_per_bin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error_per_bin&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># we got a valid bin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_binsEntries</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_entries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights</span> <span class="o">+=</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeights2</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">weight</span>

        <span class="c1"># we consider use error_per_bin as false when fill_cell() is called indirectly, either from overridden methods</span>
        <span class="c1"># of this class or from methods derived classes..</span>
        <span class="c1">#</span>
        <span class="c1"># consequently, we consider error_per_bin is true (the default value) when fill_cell() is called directly by</span>
        <span class="c1"># the user and we must do these computations..</span>
        <span class="c1">#</span>
        <span class="c1"># NB: otherwise the fill() will contain illegal data and fail when computing standard_deviation()</span>
        <span class="k">if</span> <span class="n">error_per_bin</span><span class="p">:</span>  <span class="c1"># expensive operations. use other fill_* methods</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">i_cell</span></div>

<div class="viewcode-block" id="HistND.fill_bins"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.fill_bins">[docs]</a>    <span class="k">def</span> <span class="nf">fill_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Fill the histogram using bin indexes.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): the bin indexes for each dimension. The number of arguments must be the same as</span>
<span class="sd">                the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">            kwargs (Dict): this dict can accept 1 key:</span>
<span class="sd">                weight (float) - the weight to fill in. Defaults to 1.0</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. The **index of the affected cell (global linear bin) or -1** if no cell was found or the input values</span>
<span class="sd">                are not valid</span>

<span class="sd">        NOTE:</span>
<span class="sd">            b contains indexes of the bins on each axis, not the positions on axis</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`fill_pos`, :py:meth:`fill_cell`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">:</span>
            <span class="c1"># args has the same number of arguments as the number of histogram&#39;s dimension</span>
            <span class="n">i_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># user probably provided an array/sequence</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_bins</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BufferError</span><span class="p">(</span><span class="s2">&quot;args must have the same size as the histogram&#39;s dimension. Provided: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

        <span class="c1"># we must call using error_per_bin=False, because we are doing it here below.see also big comment in fill_cell()</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;error_per_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">!=</span> <span class="n">i_cell</span><span class="p">:</span>  <span class="c1"># underflow or overflow</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

        <span class="k">return</span> <span class="n">i_cell</span></div>

<div class="viewcode-block" id="HistND.fill_pos"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.fill_pos">[docs]</a>    <span class="k">def</span> <span class="nf">fill_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Fill the histogram using a position.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): ta list of positions on each dimension. The number of arguments must be the same as</span>
<span class="sd">                the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">            kwargs (Dict): this dict can accept 1 key:</span>
<span class="sd">                weight (float) - the weight to fill in. Defaults to 1.0</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. The **index of the affected cell (global linear bin) or -1** if no cell was found or the input values</span>
<span class="sd">        are not valid</span>

<span class="sd">        NOTE:</span>
<span class="sd">            x contains coordinates not indexes of the bins</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`fill_cell`, :py:meth:`fill_bins`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">:</span>
            <span class="c1"># args has the same number of arguments as the number of histogram&#39;s dimension</span>
            <span class="n">i_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># user probably provided an array/sequence as first argument</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_pos</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">BufferError</span><span class="p">(</span><span class="s2">&quot;args must have the same size as the histogram&#39;s dimension. Provided: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

        <span class="c1"># we must call using error_per_bin=False, otherwise see big comment in fill_cell()</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;error_per_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">!=</span> <span class="n">i_cell</span><span class="p">:</span>  <span class="c1"># underflow or overflow</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">args</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">args</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">args</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">i_cell</span></div>

<div class="viewcode-block" id="HistND.fill"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.fill">[docs]</a>    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Fill the histogram.</span>

<span class="sd">        Args:</span>
<span class="sd">            args (a list of parameters): a list of positions on each dimension. The number of arguments must be the same</span>
<span class="sd">                as the number of dimensions. Or pass one argument as a sequence (same size as number of dimensions).</span>

<span class="sd">            weight (float): the weight to fill in. Defaults to 1.0</span>

<span class="sd">            kwargs (Dict): currently this parameter is not used for histograms</span>

<span class="sd">        Returns:</span>
<span class="sd">            int. The **index of the affected cell (global linear bin) or -1** if no cell was found or the input values</span>
<span class="sd">            are not valid</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`fill_cell`, :py:meth:`fill_bins`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_pos</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistND.intersect"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.intersect">[docs]</a>    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; intersection of 2 histograms</span>

<span class="sd">        Args:</span>
<span class="sd">            other: another histogram</span>

<span class="sd">        Returns:</span>
<span class="sd">            another histogram that represent the reunion of these 2 histograms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="n">n_minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">))</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">))</span>
            <span class="n">n_density</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">())</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_density</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_maxBins</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_minBins</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">n_minBins</span><span class="p">,</span> <span class="n">n_maxBins</span><span class="p">,</span> <span class="n">n_nBins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">))</span>

            <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">val2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>

            <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">val1</span> <span class="o">+</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.scale"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">scale_errors</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Scales the histograms.</span>

<span class="sd">        The values of all cells are multiplied by &#39;factor&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            factor (float): the value to scale the histogram</span>

<span class="sd">            scale_errors (bool): if true then it also scales the errors per dimension</span>

<span class="sd">        Returns:</span>
<span class="sd">            none.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scaledHist</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">scaledHist</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">scaledHist</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_binSumWeightsValues2</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span>
            <span class="n">scaledHist</span><span class="o">.</span><span class="n">_binsEntries</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_binsEntries</span><span class="p">[</span><span class="n">i_cell</span><span class="p">]</span>

            <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeights</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeights</span>
            <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeights2</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeights2</span>

        <span class="k">if</span> <span class="n">scale_errors</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">scaledHist</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
                <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>  <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeightsX</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
                <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">scaledHist</span><span class="o">.</span><span class="n">_sumWeightsX2</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds 2 histograms</span>

<span class="sd">        Args:</span>
<span class="sd">            other (HistND): another histogram, not necessary of the same dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The sum of the 2 histograms</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="n">n_minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">))</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">))</span>
            <span class="n">n_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_density</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_maxBins</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_minBins</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">n_minBins</span><span class="p">,</span> <span class="n">n_maxBins</span><span class="p">,</span> <span class="n">n_nBins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">))</span>

            <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">val2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>

            <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">val1</span> <span class="o">+</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Substract 2 histograms</span>

<span class="sd">        Args:</span>
<span class="sd">            other (HistND): another histogram, not necessary of the same dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The difference of the 2 histograms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="n">n_minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">))</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">))</span>
            <span class="n">n_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_density</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_maxBins</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_minBins</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">n_minBins</span><span class="p">,</span> <span class="n">n_maxBins</span><span class="p">,</span> <span class="n">n_nBins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">))</span>

            <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">val2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>

            <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">val1</span> <span class="o">-</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Multiply 2 histograms</span>

<span class="sd">        Args:</span>
<span class="sd">            other (HistND): a histogram of the same dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The multiplication of the 2 histograms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="n">n_minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">))</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">))</span>
            <span class="n">n_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_density</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_maxBins</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_minBins</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">n_minBins</span><span class="p">,</span> <span class="n">n_maxBins</span><span class="p">,</span> <span class="n">n_nBins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">))</span>

            <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">val2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>

            <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">val1</span> <span class="o">*</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Divide 2 histograms</span>

<span class="sd">        Args:</span>
<span class="sd">            other (HistND): a histogram of the same dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The sum of the 2 histograms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="n">n_minBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_maxBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_nBins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">))</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">))</span>
            <span class="n">n_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_density</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_maxBins</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">n_minBins</span><span class="p">[</span><span class="n">d</span><span class="p">])))</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">n_minBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minBin</span><span class="p">)</span>
            <span class="n">n_maxBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">maxBin</span><span class="p">)</span>
            <span class="n">n_nBins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">nbins</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">HistND</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="n">n_minBins</span><span class="p">,</span> <span class="n">n_maxBins</span><span class="p">,</span> <span class="n">n_nBins</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">idx_bins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">id_bin</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_bins</span><span class="p">):</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_center</span><span class="p">(</span><span class="n">id_bin</span><span class="p">))</span>

            <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="n">val2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_pos_content</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">fill_cell</span><span class="p">(</span><span class="n">i_cell</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">val1</span> <span class="o">/</span> <span class="n">val2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="HistND.integral"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.integral">[docs]</a>    <span class="k">def</span> <span class="nf">integral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minCellId</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxCellId</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Computes integral over cells range &#39;[minCellId, maxCellId]&#39;</span>

<span class="sd">        The integral is the sum over all cells of the product of cell&#39;s content and the volume described by its bins:</span>
<span class="sd">            I = Sum_i CELL_CONTENT dx * dy * dz * ... dXn</span>

<span class="sd">        Args:</span>
<span class="sd">            minCellId (int): minimum cell id.</span>
<span class="sd">                Default it is 0 (zero).</span>

<span class="sd">            maxCellId (int): maximum cell id.</span>
<span class="sd">                default is None, meaning all cells</span>

<span class="sd">        Returns:</span>
<span class="sd">            float.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`integral_over_bins`, :py:meth:`integral_over_pos`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">minCellId</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">maxCellId</span>

        <span class="k">if</span> <span class="n">maxCellId</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span>

        <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="n">a</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;minCellId can not be negative or bigger then the maximum cells&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="n">b</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;maxCellId can not be negative or bigger then the maximum cells&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;minCellId is bigger or equal to the maxCellId. Returning zero..&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="n">result</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cell_content</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
            <span class="n">cellBins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_to_bins</span><span class="p">(</span><span class="n">i_cell</span><span class="p">)</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cellBins</span><span class="p">):</span>
                <span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">get_bin_width</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">volume</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="HistND.integral_over_bins"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.integral_over_bins">[docs]</a>    <span class="k">def</span> <span class="nf">integral_over_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minBinsIds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">maxBinsIds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Computes integral over bins range</span>

<span class="sd">        Args:</span>
<span class="sd">            minBinsIds (Sequence): an array of ints containing the minimum bins over each dimension</span>

<span class="sd">            maxBinsIds (Sequence): an array of ints containing the maximum bins over each dimension</span>

<span class="sd">        Returns:</span>
<span class="sd">            float.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`integral`, :py:meth:`integral_over_pos`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">min_cell_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">minBinsIds</span><span class="p">)</span>
        <span class="n">max_cell_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">maxBinsIds</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">min_cell_id</span><span class="p">,</span> <span class="n">max_cell_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="HistND.integral_over_pos"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.HistND.integral_over_pos">[docs]</a>    <span class="k">def</span> <span class="nf">integral_over_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minPos</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">maxPos</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Computes integral between 2 positions.</span>

<span class="sd">        Args:</span>
<span class="sd">            minPos (Sequence): an array of floats containing the minimum position on each dimension</span>

<span class="sd">            maxPos (Sequence): an array of floats containing the maximum position on each dimension</span>

<span class="sd">        Returns:</span>
<span class="sd">            float.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :py:meth:`integral`, :py:meth:`integral_over_pos`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">min_cell_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">minPos</span><span class="p">)</span>
        <span class="n">max_cell_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_to_cell</span><span class="p">(</span><span class="o">*</span><span class="n">maxPos</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">min_cell_id</span><span class="p">,</span> <span class="n">max_cell_id</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Hist1D"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist1D">[docs]</a><span class="k">class</span> <span class="nc">Hist1D</span><span class="p">(</span><span class="n">HistND</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A 1-Dimensional Histogram</span>

<span class="sd">    Args:</span>
<span class="sd">        minBin (float): the minimum value of lower edge of bins</span>

<span class="sd">        maxBin (float): the maximum value of upper edge of bins</span>

<span class="sd">        nBins (integer): the number of bins</span>

<span class="sd">        title (string): the title of the histogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nBins</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">minBin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">maxBin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">()):</span>
        <span class="n">HistND</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">minBin</span><span class="p">],</span> <span class="p">[</span><span class="n">maxBin</span><span class="p">],</span> <span class="p">[</span><span class="n">nBins</span><span class="p">],</span> <span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Hist2D"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist2D">[docs]</a><span class="k">class</span> <span class="nc">Hist2D</span><span class="p">(</span><span class="n">HistND</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A 2-Dimensional Histogram</span>

<span class="sd">    Args:</span>
<span class="sd">        nBinsX (integer): the number of bins on the X-axis</span>

<span class="sd">        minBinX (float): the minimum value of lower edge of bins on the X-axis</span>

<span class="sd">        maxBinX (float): the maximum value of upper edge of bins on the X-axis</span>

<span class="sd">        nBinsY (integer): the number of bins on the Y-axis</span>

<span class="sd">        minBinY (float): the minimum value of lower edge of bins on the Y-axis</span>

<span class="sd">        maxBinY (float): the maximum value of upper edge of bins on the Y-axis</span>

<span class="sd">        title (string): the title of the histogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nBinsX</span><span class="p">,</span> <span class="n">minBinX</span><span class="p">,</span> <span class="n">maxBinX</span><span class="p">,</span> <span class="n">nBinsY</span><span class="p">,</span> <span class="n">minBinY</span><span class="p">,</span> <span class="n">maxBinY</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">()):</span>
        <span class="n">HistND</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">minBinX</span><span class="p">,</span> <span class="n">minBinY</span><span class="p">],</span> <span class="p">[</span><span class="n">maxBinX</span><span class="p">,</span> <span class="n">maxBinY</span><span class="p">],</span> <span class="p">[</span><span class="n">nBinsX</span><span class="p">,</span> <span class="n">nBinsY</span><span class="p">],</span> <span class="n">title</span><span class="p">)</span>

<div class="viewcode-block" id="Hist2D.projection_x"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist2D.projection_x">[docs]</a>    <span class="k">def</span> <span class="nf">projection_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the X-axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist2D.projection_y"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist2D.projection_y">[docs]</a>    <span class="k">def</span> <span class="nf">projection_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the Y-axis</span>

<span class="sd">         Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Hist3D"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D">[docs]</a><span class="k">class</span> <span class="nc">Hist3D</span><span class="p">(</span><span class="n">HistND</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A 3-Dimensional Histogram</span>

<span class="sd">    Args:</span>
<span class="sd">        nBinsX (integer): the number of bins on the X-axis</span>

<span class="sd">        minBinX (float): the minimum value of lower edge of bins on the X-axis</span>

<span class="sd">        maxBinX (float): the maximum value of upper edge of bins on the X-axis</span>

<span class="sd">        nBinsY (integer): the number of bins on the Y-axis</span>

<span class="sd">        minBinY (float): the minimum value of lower edge of bins on the Y-axis</span>

<span class="sd">        maxBinY (float): the maximum value of upper edge of bins on the Y-axis</span>

<span class="sd">        nBinsZ (integer): the number of bins on the Z-axis</span>

<span class="sd">        minBinZ (float): the minimum value of lower edge of bins on the Z-axis</span>

<span class="sd">        maxBinZ (float): the maximum value of upper edge of bins on the Z-axis</span>

<span class="sd">        title (string): the title of the histogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nBinsX</span><span class="p">,</span> <span class="n">minBinX</span><span class="p">,</span> <span class="n">maxBinX</span><span class="p">,</span> <span class="n">nBinsY</span><span class="p">,</span> <span class="n">minBinY</span><span class="p">,</span> <span class="n">maxBinY</span><span class="p">,</span> <span class="n">nBinsZ</span><span class="p">,</span> <span class="n">minBinZ</span><span class="p">,</span> <span class="n">maxBinZ</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">()):</span>
        <span class="n">HistND</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">minBinX</span><span class="p">,</span> <span class="n">minBinY</span><span class="p">,</span> <span class="n">minBinZ</span><span class="p">],</span> <span class="p">[</span><span class="n">maxBinX</span><span class="p">,</span> <span class="n">maxBinY</span><span class="p">,</span> <span class="n">maxBinZ</span><span class="p">],</span> <span class="p">[</span><span class="n">nBinsX</span><span class="p">,</span> <span class="n">nBinsY</span><span class="p">,</span> <span class="n">nBinsZ</span><span class="p">],</span>
                        <span class="n">title</span><span class="p">)</span>

<div class="viewcode-block" id="Hist3D.projection_x"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_x">[docs]</a>    <span class="k">def</span> <span class="nf">projection_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the X-axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist3D.projection_y"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_y">[docs]</a>    <span class="k">def</span> <span class="nf">projection_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the Y-axis</span>

<span class="sd">         Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist3D.projection_z"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_z">[docs]</a>    <span class="k">def</span> <span class="nf">projection_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the Z-axis</span>

<span class="sd">         Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist3D.projection_xy"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_xy">[docs]</a>    <span class="k">def</span> <span class="nf">projection_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the X-axis and Y-axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist3D.projection_xz"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_xz">[docs]</a>    <span class="k">def</span> <span class="nf">projection_xz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the X-axis and Z-axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hist3D.projection_yz"><a class="viewcode-back" href="../../reference_hist.html#qksplot.hist.Hist3D.projection_yz">[docs]</a>    <span class="k">def</span> <span class="nf">projection_yz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Project this histogram on the Y-axis and Z-axis</span>

<span class="sd">        Returns:</span>
<span class="sd">            HistND. The projected histogram has dimension 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">qksplot 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Mihai Niculescu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>